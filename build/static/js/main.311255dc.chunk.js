(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{16:function(e,t,a){e.exports=a(29)},21:function(e,t,a){},24:function(e,t,a){},29:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(14),s=a.n(r),c=(a(21),a(5)),l=a(6),i=a(8),h=a(7),u=a(9),f=a(31),d=a(30),m=a(12),p="https://reactnd-books-api.udacity.com",v=localStorage.token;v||(v=localStorage.token=Math.random().toString(36).substr(-8));var k={Accept:"application/json",Authorization:v},b=function(){return fetch("".concat(p,"/books"),{headers:k}).then(function(e){return e.json()}).then(function(e){return e.books})},y=function(e,t){return fetch("".concat(p,"/books/").concat(e.id),{method:"PUT",headers:Object(m.a)({},k,{"Content-Type":"application/json"}),body:JSON.stringify({shelf:t})}).then(function(e){return e.json()})},g=function(e){return fetch("".concat(p,"/search"),{method:"POST",headers:Object(m.a)({},k,{"Content-Type":"application/json"}),body:JSON.stringify({query:e})}).then(function(e){return e.json()}).then(function(e){return e.books})},E=(a(24),function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(i.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={isUpdating:!1},a.changeShelf=function(e){a.props.onChangeShelf(a.props.book,e),a.setState({isUpdating:!0})},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentWillReceiveProps",value:function(){this.setState({isUpdating:!1})}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:this.state.isUpdating?"book-shelf-changer loading":"book-shelf-changer"},o.a.createElement("select",{value:this.props.book.shelf,onChange:function(t){return e.changeShelf(t)}},o.a.createElement("option",{value:"move",disabled:!0},"Move to..."),o.a.createElement("option",{value:"currentlyReading"},"Currently Reading"),o.a.createElement("option",{value:"wantToRead"},"Want to Read"),o.a.createElement("option",{value:"read"},"Read"),o.a.createElement("option",{value:"none"},"None")),this.state.isUpdating&&o.a.createElement("div",{className:"book-shelf-changer-loader"}))}}]),t}(n.Component));var S=function(e){var t=e.book,a=e.onChangeShelf,n=void 0===t.imageLinks?"https://dummyimage.com/128x193/333/ffffff&text=missing+image":t.imageLinks.thumbnail,r=void 0===t.authors?"Unknown Author":t.authors.join(", ");return o.a.createElement("li",null,o.a.createElement("div",{className:"book"},o.a.createElement("div",{className:"book-top"},o.a.createElement("div",{className:"book-cover",style:{width:128,height:193,backgroundImage:"url(".concat(n,")")}}),o.a.createElement(E,{book:t,onChangeShelf:a})),o.a.createElement("div",{className:"book-title"},t.title),o.a.createElement("div",{className:"book-authors"},r)))};var N=function(e){return o.a.createElement("div",{className:"bookshelf"},o.a.createElement("h2",{className:"bookshelf-title"},e.shelfName),o.a.createElement("div",{className:"bookshelf-books"},e.appLoaded?e.fBooks.length<=0?o.a.createElement("h3",{className:"bookshelf-status"},"Empty Shelf"):o.a.createElement("ol",{className:"books-grid"},e.fBooks.map(function(t){return o.a.createElement(S,{key:t.id,book:t,onChangeShelf:e.onChangeShelf})})):o.a.createElement("div",{className:"loader"})))},j=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(i.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={query:"",searchBooks:[],isSearching:!1},a.updateQuery=function(e){a.setState({query:e.target.value},function(){a.searchBooks(e)})},a.searchBooks=function(e){a.state.query?(a.setState({isSearching:!0}),g(a.state.query).then(function(e){e.error?a.setState({searchBooks:[]}):e&&a.updateBooks(e)})):a.setState({searchBooks:[]})},a.updateBooks=function(e){var t=e,n=!0,o=!1,r=void 0;try{for(var s,c=t[Symbol.iterator]();!(n=(s=c.next()).done);n=!0){var l=s.value;l.shelf="none";var i=!0,h=!1,u=void 0;try{for(var f,d=a.props.shelvedBooks[Symbol.iterator]();!(i=(f=d.next()).done);i=!0){var m=f.value;l.id===m.id&&(l.shelf=m.shelf)}}catch(p){h=!0,u=p}finally{try{i||null==d.return||d.return()}finally{if(h)throw u}}}}catch(p){o=!0,r=p}finally{try{n||null==c.return||c.return()}finally{if(o)throw r}}a.setState({searchBooks:t,isSearching:!1})},a.updateBook=function(e){var t=a.state.searchBooks,n=!0,o=!1,r=void 0;try{for(var s,c=t[Symbol.iterator]();!(n=(s=c.next()).done);n=!0){var l=s.value,i=!0,h=!1,u=void 0;try{for(var f,d=e[Symbol.iterator]();!(i=(f=d.next()).done);i=!0){var m=f.value;l.id===m.id&&(l.shelf=m.shelf)}}catch(p){h=!0,u=p}finally{try{i||null==d.return||d.return()}finally{if(h)throw u}}}}catch(p){o=!0,r=p}finally{try{n||null==c.return||c.return()}finally{if(o)throw r}}a.setState({searchBooks:t})},a.changeShelf=function(e,t){a.props.onChangeShelf(e,t).then(function(e){return a.updateBook(e)})},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.state.searchBooks;return o.a.createElement("div",{className:"search-books"},o.a.createElement("div",{className:"search-books-bar"},o.a.createElement(d.a,{to:"/",className:"close-search"},"Close"),o.a.createElement("div",{className:"search-books-input-wrapper"},o.a.createElement("input",{type:"text",value:this.state.query,placeholder:"Search by title or author",onChange:function(t){return e.updateQuery(t)}}))),this.state.isSearching?o.a.createElement("div",{className:"loader"}):o.a.createElement("div",{className:"search-books-results"},o.a.createElement("ol",{className:"books-grid"},t.map(function(t){return o.a.createElement(S,{key:t.id,book:t,onChangeShelf:e.changeShelf})}))))}}]),t}(n.Component),B=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(i.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={books:[],isLoaded:!1},a.changeShelf=function(e,t){return new Promise(function(n){y(e,t.target.value).then(function(e){b().then(function(e){a.setState({books:e},n(e))})})})},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;b().then(function(t){e.setState({books:t,isLoaded:!0})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.isLoaded,n=t.books;return o.a.createElement("div",{className:"app"},o.a.createElement(f.a,{path:"/search",render:function(){return o.a.createElement(j,{shelvedBooks:n,onChangeShelf:e.changeShelf})}}),o.a.createElement(f.a,{exact:!0,path:"/",render:function(){return o.a.createElement("div",{className:"list-books"},o.a.createElement("div",{className:"list-books-title"},o.a.createElement("h1",null,"MyReads")),o.a.createElement("div",{className:"list-books-content"},o.a.createElement("div",null,o.a.createElement(N,{key:"Currently Reading",shelfName:"Currently Reading",appLoaded:a,fBooks:n.filter(function(e){return"currentlyReading"===e.shelf}),onChangeShelf:e.changeShelf}),o.a.createElement(N,{key:"Want to Read",shelfName:"Want to Read",appLoaded:a,fBooks:n.filter(function(e){return"wantToRead"===e.shelf}),onChangeShelf:e.changeShelf}),o.a.createElement(N,{key:"Read",shelfName:"Read",appLoaded:a,fBooks:n.filter(function(e){return"read"===e.shelf}),onChangeShelf:e.changeShelf}))),o.a.createElement("div",{className:"open-search"},o.a.createElement(d.a,{to:"/search"},"Add Book")))}}))}}]),t}(n.Component),C=a(32);s.a.render(o.a.createElement(C.a,null,o.a.createElement(B,null)),document.getElementById("root"))}},[[16,2,1]]]);
//# sourceMappingURL=main.311255dc.chunk.js.map