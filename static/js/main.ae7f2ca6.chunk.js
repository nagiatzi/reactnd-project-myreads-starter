(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{16:function(e,t,a){e.exports=a(29)},21:function(e,t,a){},24:function(e,t,a){},29:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(14),c=a.n(r),i=(a(21),a(5)),s=a(6),l=a(8),h=a(7),u=a(9),f=a(31),d=a(30),m=a(12),v="https://reactnd-books-api.udacity.com",p=localStorage.token;p||(p=localStorage.token=Math.random().toString(36).substr(-8));var g={Accept:"application/json",Authorization:p},k=function(){return fetch("".concat(v,"/books"),{headers:g}).then(function(e){return e.json()}).then(function(e){return e.books})},b=function(e,t){return fetch("".concat(v,"/books/").concat(e.id),{method:"PUT",headers:Object(m.a)({},g,{"Content-Type":"application/json"}),body:JSON.stringify({shelf:t})}).then(function(e){return e.json()})},y=function(e){return fetch("".concat(v,"/search"),{method:"POST",headers:Object(m.a)({},g,{"Content-Type":"application/json"}),body:JSON.stringify({query:e})}).then(function(e){return e.json()}).then(function(e){return e.books})},E=(a(24),function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={isUpdating:!1},a.changeShelf=function(e){a.props.onChangeShelf(a.props.book,e),a.setState({isUpdating:!0})},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentWillReceiveProps",value:function(){this.setState({isUpdating:!1})}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:this.state.isUpdating?"book-shelf-changer loading":"book-shelf-changer"},o.a.createElement("select",{value:this.props.book.shelf,onChange:function(t){return e.changeShelf(t)}},o.a.createElement("option",{value:"move",disabled:!0},"Move to..."),o.a.createElement("option",{value:"currentlyReading"},"Currently Reading"),o.a.createElement("option",{value:"wantToRead"},"Want to Read"),o.a.createElement("option",{value:"read"},"Read"),o.a.createElement("option",{value:"none"},"None")),this.state.isUpdating&&o.a.createElement("div",{className:"book-shelf-changer-loader"}))}}]),t}(n.Component));var S=function(e){var t=e.book,a=e.onChangeShelf,n=void 0===t.imageLinks?"https://dummyimage.com/128x193/333/ffffff&text=missing+image":t.imageLinks.thumbnail,r=void 0===t.authors?"Unknown Author":t.authors.join(", ");return o.a.createElement("li",null,o.a.createElement("div",{className:"book"},o.a.createElement("div",{className:"book-top"},o.a.createElement("div",{className:"book-cover",style:{width:128,height:193,backgroundImage:"url(".concat(n,")")}}),o.a.createElement(E,{book:t,onChangeShelf:a})),o.a.createElement("div",{className:"book-title"},t.title),o.a.createElement("div",{className:"book-authors"},r)))};var w=function(e){return o.a.createElement("div",{className:"bookshelf"},o.a.createElement("h2",{className:"bookshelf-title"},e.shelfName),o.a.createElement("div",{className:"bookshelf-books"},e.appLoaded?e.fBooks.length<=0?o.a.createElement("h3",{className:"bookshelf-status"},"Empty Shelf"):o.a.createElement("ol",{className:"books-grid"},e.fBooks.map(function(t){return o.a.createElement(S,{key:t.id,book:t,onChangeShelf:e.onChangeShelf})})):o.a.createElement("div",{className:"loader"})))},N=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={query:"",searchBooks:[],isSearching:!1},a.updateQuery=function(e){a.setState({query:e.target.value},function(){a.searchBooks(e)})},a.searchBooks=function(e){a.state.query?(a.setState({isSearching:!0}),y(a.state.query).then(function(e){e.error?a.setState({searchBooks:[]}):e&&a.updateBooks(e)})):a.setState({searchBooks:[]})},a.updateBooks=function(e){var t=e,n=!0,o=!1,r=void 0;try{for(var c,i=t[Symbol.iterator]();!(n=(c=i.next()).done);n=!0){var s=c.value;s.shelf="none";var l=!0,h=!1,u=void 0;try{for(var f,d=a.props.shelvedBooks[Symbol.iterator]();!(l=(f=d.next()).done);l=!0){var m=f.value;s.id===m.id&&(s.shelf=m.shelf)}}catch(v){h=!0,u=v}finally{try{l||null==d.return||d.return()}finally{if(h)throw u}}}}catch(v){o=!0,r=v}finally{try{n||null==i.return||i.return()}finally{if(o)throw r}}a.setState({searchBooks:t,isSearching:!1})},a.updateBook=function(e){var t=a.state.searchBooks,n=!0,o=!1,r=void 0;try{for(var c,i=t[Symbol.iterator]();!(n=(c=i.next()).done);n=!0){var s=c.value,l=!0,h=!1,u=void 0;try{for(var f,d=e[Symbol.iterator]();!(l=(f=d.next()).done);l=!0){var m=f.value;s.id===m.id&&(s.shelf=m.shelf)}}catch(v){h=!0,u=v}finally{try{l||null==d.return||d.return()}finally{if(h)throw u}}}}catch(v){o=!0,r=v}finally{try{n||null==i.return||i.return()}finally{if(o)throw r}}a.setState({searchBooks:t})},a.changeShelf=function(e,t){a.props.onChangeShelf(e,t).then(function(e){return a.updateBook(e)})},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.state.searchBooks;return o.a.createElement("div",{className:"search-books"},o.a.createElement("div",{className:"search-books-bar"},o.a.createElement(d.a,{to:"/",className:"close-search"},"Close"),o.a.createElement("div",{className:"search-books-input-wrapper"},o.a.createElement("input",{type:"text",value:this.state.query,placeholder:"Search by title or author",onChange:function(t){return e.updateQuery(t)}}))),this.state.isSearching?o.a.createElement("div",{className:"loader"}):o.a.createElement("div",{className:"search-books-results"},o.a.createElement("ol",{className:"books-grid"},t.map(function(t){return o.a.createElement(S,{key:t.id,book:t,onChangeShelf:e.changeShelf})}))))}}]),t}(n.Component),j=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={books:[],isLoaded:!1},a.changeShelf=function(e,t){return new Promise(function(n){b(e,t.target.value).then(function(e){k().then(function(e){a.setState({books:e},n(e))})})})},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;k().then(function(t){e.setState({books:t,isLoaded:!0})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.isLoaded,n=t.books;return o.a.createElement("div",{className:"app"},o.a.createElement(f.a,{path:"/search",render:function(){return o.a.createElement(N,{shelvedBooks:n,onChangeShelf:e.changeShelf})}}),o.a.createElement(f.a,{exact:!0,path:"/",render:function(){return o.a.createElement("div",{className:"list-books"},o.a.createElement("div",{className:"list-books-title"},o.a.createElement("h1",null,"MyReads")),o.a.createElement("div",{className:"list-books-content"},o.a.createElement("div",null,o.a.createElement(w,{key:"Currently Reading",shelfName:"Currently Reading",appLoaded:a,fBooks:n.filter(function(e){return"currentlyReading"===e.shelf}),onChangeShelf:e.changeShelf}),o.a.createElement(w,{key:"Want to Read",shelfName:"Want to Read",appLoaded:a,fBooks:n.filter(function(e){return"wantToRead"===e.shelf}),onChangeShelf:e.changeShelf}),o.a.createElement(w,{key:"Read",shelfName:"Read",appLoaded:a,fBooks:n.filter(function(e){return"read"===e.shelf}),onChangeShelf:e.changeShelf}))),o.a.createElement("div",{className:"open-search"},o.a.createElement(d.a,{to:"/search"},"Add Book")))}}))}}]),t}(n.Component),C=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function B(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}var O=a(32);c.a.render(o.a.createElement(O.a,null,o.a.createElement(j,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/MyReads",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/MyReads","/service-worker.js");C?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):B(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):B(e)})}}()}},[[16,2,1]]]);
//# sourceMappingURL=main.ae7f2ca6.chunk.js.map