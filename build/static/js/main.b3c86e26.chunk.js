(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{16:function(e,t,n){e.exports=n(29)},21:function(e,t,n){},24:function(e,t,n){},29:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(14),c=n.n(r),i=(n(21),n(5)),s=n(6),l=n(8),h=n(7),u=n(9),f=n(31),d=n(30),m=n(12),v="https://reactnd-books-api.udacity.com",p=localStorage.token;p||(p=localStorage.token=Math.random().toString(36).substr(-8));var g={Accept:"application/json",Authorization:p},k=function(){return fetch("".concat(v,"/books"),{headers:g}).then(function(e){return e.json()}).then(function(e){return e.books})},b=function(e,t){return fetch("".concat(v,"/books/").concat(e.id),{method:"PUT",headers:Object(m.a)({},g,{"Content-Type":"application/json"}),body:JSON.stringify({shelf:t})}).then(function(e){return e.json()})},y=function(e){return fetch("".concat(v,"/search"),{method:"POST",headers:Object(m.a)({},g,{"Content-Type":"application/json"}),body:JSON.stringify({query:e})}).then(function(e){return e.json()}).then(function(e){return e.books})},E=(n(24),function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(l.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={isUpdating:!1},n.changeShelf=function(e){n.props.onChangeShelf(n.props.book,e),n.setState({isUpdating:!0})},n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentWillReceiveProps",value:function(){this.setState({isUpdating:!1})}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:this.state.isUpdating?"book-shelf-changer loading":"book-shelf-changer"},o.a.createElement("select",{value:this.props.book.shelf,onChange:function(t){return e.changeShelf(t)}},o.a.createElement("option",{value:"move",disabled:!0},"Move to..."),o.a.createElement("option",{value:"currentlyReading"},"Currently Reading"),o.a.createElement("option",{value:"wantToRead"},"Want to Read"),o.a.createElement("option",{value:"read"},"Read"),o.a.createElement("option",{value:"none"},"None")),this.state.isUpdating&&o.a.createElement("div",{className:"book-shelf-changer-loader"}))}}]),t}(a.Component));var S=function(e){var t=e.book,n=e.onChangeShelf,a=void 0===t.imageLinks?"https://dummyimage.com/128x193/333/ffffff&text=missing+image":t.imageLinks.thumbnail,r=void 0===t.authors?"Unknown Author":t.authors.join(", ");return o.a.createElement("li",null,o.a.createElement("div",{className:"book"},o.a.createElement("div",{className:"book-top"},o.a.createElement("div",{className:"book-cover",style:{width:128,height:193,backgroundImage:"url(".concat(a,")")}}),o.a.createElement(E,{book:t,onChangeShelf:n})),o.a.createElement("div",{className:"book-title"},t.title),o.a.createElement("div",{className:"book-authors"},r)))};var w=function(e){return o.a.createElement("div",{className:"bookshelf"},o.a.createElement("h2",{className:"bookshelf-title"},e.shelfName),o.a.createElement("div",{className:"bookshelf-books"},e.appLoaded?e.fBooks.length<=0?o.a.createElement("h3",{className:"bookshelf-status"},"Empty Shelf"):o.a.createElement("ol",{className:"books-grid"},e.fBooks.map(function(t){return o.a.createElement(S,{key:t.id,book:t,onChangeShelf:e.onChangeShelf})})):o.a.createElement("div",{className:"loader"})))},N=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(l.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={query:"",sBooks:[],isSearching:!1},n.updateQuery=function(e){n.setState({query:e.target.value},function(){n.searchBooks(e)})},n.searchBooks=function(e){n.state.query?(n.setState({isSearching:!0}),y(n.state.query).then(function(e){e.error?n.setState({sBooks:[]}):e&&n.updateBooks(e)})):n.setState({sBooks:[]})},n.updateBooks=function(e){var t=e,a=!0,o=!1,r=void 0;try{for(var c,i=t[Symbol.iterator]();!(a=(c=i.next()).done);a=!0){var s=c.value;s.shelf="none";var l=!0,h=!1,u=void 0;try{for(var f,d=n.props.shelvedBooks[Symbol.iterator]();!(l=(f=d.next()).done);l=!0){var m=f.value;s.id===m.id&&(s.shelf=m.shelf)}}catch(v){h=!0,u=v}finally{try{l||null==d.return||d.return()}finally{if(h)throw u}}}}catch(v){o=!0,r=v}finally{try{a||null==i.return||i.return()}finally{if(o)throw r}}n.setState({sBooks:t,isSearching:!1})},n.updateBook=function(e){var t=n.state.sBooks,a=!0,o=!1,r=void 0;try{for(var c,i=t[Symbol.iterator]();!(a=(c=i.next()).done);a=!0){var s=c.value,l=!0,h=!1,u=void 0;try{for(var f,d=e[Symbol.iterator]();!(l=(f=d.next()).done);l=!0){var m=f.value;s.id===m.id&&(s.shelf=m.shelf)}}catch(v){h=!0,u=v}finally{try{l||null==d.return||d.return()}finally{if(h)throw u}}}}catch(v){o=!0,r=v}finally{try{a||null==i.return||i.return()}finally{if(o)throw r}}n.setState({sBooks:t})},n.changeShelf=function(e,t){n.props.onChangeShelf(e,t).then(function(e){return n.updateBook(e)})},n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.state.sBooks;return o.a.createElement("div",{className:"search-books"},o.a.createElement("div",{className:"search-books-bar"},o.a.createElement(d.a,{to:"/",className:"close-search"},"Close"),o.a.createElement("div",{className:"search-books-input-wrapper"},o.a.createElement("input",{type:"text",value:this.state.query,placeholder:"Search by title or author",onChange:function(t){return e.updateQuery(t)}}))),this.state.isSearching?o.a.createElement("div",{className:"loader"}):o.a.createElement("div",{className:"search-books-results"},o.a.createElement("ol",{className:"books-grid"},t.map(function(t){return o.a.createElement(S,{key:t.id,book:t,onChangeShelf:e.changeShelf})}))))}}]),t}(a.Component),j=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(l.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={books:[],isLoaded:!1},n.changeShelf=function(e,t){return new Promise(function(a){b(e,t.target.value).then(function(e){k().then(function(e){n.setState({books:e},a(e))})})})},n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;k().then(function(t){e.setState({books:t,isLoaded:!0})})}},{key:"render",value:function(){var e=this,t=this.state,n=t.isLoaded,a=t.books;return o.a.createElement("div",{className:"app"},o.a.createElement(f.a,{path:"/search",render:function(){return o.a.createElement(N,{shelvedBooks:a,onChangeShelf:e.changeShelf})}}),o.a.createElement(f.a,{exact:!0,path:"/",render:function(){return o.a.createElement("div",{className:"list-books"},o.a.createElement("div",{className:"list-books-title"},o.a.createElement("h1",null,"MyReads")),o.a.createElement("div",{className:"list-books-content"},o.a.createElement("div",null,o.a.createElement(w,{key:"Currently Reading",shelfName:"Currently Reading",appLoaded:n,fBooks:a.filter(function(e){return"currentlyReading"===e.shelf}),onChangeShelf:e.changeShelf}),o.a.createElement(w,{key:"Want to Read",shelfName:"Want to Read",appLoaded:n,fBooks:a.filter(function(e){return"wantToRead"===e.shelf}),onChangeShelf:e.changeShelf}),o.a.createElement(w,{key:"Read",shelfName:"Read",appLoaded:n,fBooks:a.filter(function(e){return"read"===e.shelf}),onChangeShelf:e.changeShelf}))),o.a.createElement("div",{className:"open-search"},o.a.createElement(d.a,{to:"/search"},"Add Book")))}}))}}]),t}(a.Component),C=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function B(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}var O=n(32);c.a.render(o.a.createElement(O.a,null,o.a.createElement(j,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/MyReads",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/MyReads","/service-worker.js");C?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):B(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):B(e)})}}()}},[[16,2,1]]]);
//# sourceMappingURL=main.b3c86e26.chunk.js.map